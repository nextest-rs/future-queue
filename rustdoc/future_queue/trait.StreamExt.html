<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="An extension trait for `Stream`s that provides `future_queue`."><title>StreamExt in future_queue - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="future_queue" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.0 (f8297e351 2025-10-28)" data-channel="1.91.0" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">StreamExt</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../future_queue/index.html">future_<wbr>queue</a><span class="version">0.4.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Stream<wbr>Ext</a></h2><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.future_queue" title="future_queue">future_queue</a></li><li><a href="#method.future_queue_grouped" title="future_queue_grouped">future_queue_grouped</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="index.html">In crate future_<wbr>queue</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="index.html">future_queue</a></div><h1>Trait <span class="trait">Stream<wbr>Ext</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/future_queue/lib.rs.html#186-266">Source</a> </span></div><pre class="rust item-decl"><code>pub trait StreamExt: <a class="trait" href="../futures_core/stream/trait.Stream.html" title="trait futures_core::stream::Stream">Stream</a> {
    // Provided methods
    fn <a href="#method.future_queue" class="fn">future_queue</a>&lt;F, Fut&gt;(self, max_weight: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>) -&gt; <a class="struct" href="struct.FutureQueue.html" title="struct future_queue::FutureQueue">FutureQueue</a>&lt;Self&gt;
       <span class="where">where Self: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a> + <a class="trait" href="../futures_core/stream/trait.Stream.html" title="trait futures_core::stream::Stream">Stream</a>&lt;Item = (<a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>, F)&gt;,
             F: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="struct" href="struct.FutureQueueContext.html" title="struct future_queue::FutureQueueContext">FutureQueueContext</a>) -&gt; Fut,
             Fut: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a></span> { ... }
<span class="item-spacer"></span>    fn <a href="#method.future_queue_grouped" class="fn">future_queue_grouped</a>&lt;F, Fut, I, K, Q&gt;(
        self,
        max_global_weight: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>,
        groups: I,
    ) -&gt; <a class="struct" href="struct.FutureQueueGrouped.html" title="struct future_queue::FutureQueueGrouped">FutureQueueGrouped</a>&lt;Self, K&gt;
       <span class="where">where I: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = (K, <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>)&gt;,
             K: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/cmp/trait.Eq.html" title="trait core::cmp::Eq">Eq</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/hash/trait.Hash.html" title="trait core::hash::Hash">Hash</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;Q&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a>,
             Q: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/cmp/trait.Eq.html" title="trait core::cmp::Eq">Eq</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/hash/trait.Hash.html" title="trait core::hash::Hash">Hash</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a>,
             Self: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a> + <a class="trait" href="../futures_core/stream/trait.Stream.html" title="trait futures_core::stream::Stream">Stream</a>&lt;Item = (<a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>, <a class="enum" href="https://doc.rust-lang.org/1.91.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;Q&gt;, F)&gt;,
             F: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="struct" href="struct.FutureQueueContext.html" title="struct future_queue::FutureQueueContext">FutureQueueContext</a>) -&gt; Fut,
             Fut: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a></span> { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>An extension trait for <code>Stream</code>s that provides
<a href="trait.StreamExt.html#method.future_queue" title="method future_queue::StreamExt::future_queue"><code>future_queue</code></a>.</p>
</div></details><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.future_queue" class="method"><a class="src rightside" href="../src/future_queue/lib.rs.html#208-215">Source</a><h4 class="code-header">fn <a href="#method.future_queue" class="fn">future_queue</a>&lt;F, Fut&gt;(self, max_weight: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>) -&gt; <a class="struct" href="struct.FutureQueue.html" title="struct future_queue::FutureQueue">FutureQueue</a>&lt;Self&gt;<div class="where">where
    Self: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a> + <a class="trait" href="../futures_core/stream/trait.Stream.html" title="trait futures_core::stream::Stream">Stream</a>&lt;Item = (<a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>, F)&gt;,
    F: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="struct" href="struct.FutureQueueContext.html" title="struct future_queue::FutureQueueContext">FutureQueueContext</a>) -&gt; Fut,
    Fut: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>,</div></h4></section></summary><div class="docblock"><p>An adaptor for creating a queue of pending futures (unordered), where each future has a
different weight.</p>
<p>This stream must return values of type <code>(usize, impl Future)</code>, where the <code>usize</code> indicates
the weight of each future. This adaptor will buffer futures up to weight <code>max_weight</code>, and
then return the outputs in the order in which they complete.</p>
<ul>
<li>The maximum weight is never exceeded while futures are being run.</li>
<li>If the weight of an individual future is greater than the maximum weight, its weight will
be set to the maximum weight.</li>
</ul>
<p>The adaptor will schedule futures in the order they’re returned by the stream, without doing
any reordering based on weight.</p>
<p>The weight of a future can be zero, in which case it will not count towards the total weight.</p>
<p>The returned stream will be a stream of each future’s output.</p>
<h5 id="examples"><a class="doc-anchor" href="#examples">§</a>Examples</h5>
<p>See <a href="index.html#examples" title="mod future_queue">the crate documentation</a> for an example.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.future_queue_grouped" class="method"><a class="src rightside" href="../src/future_queue/lib.rs.html#251-265">Source</a><h4 class="code-header">fn <a href="#method.future_queue_grouped" class="fn">future_queue_grouped</a>&lt;F, Fut, I, K, Q&gt;(
    self,
    max_global_weight: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>,
    groups: I,
) -&gt; <a class="struct" href="struct.FutureQueueGrouped.html" title="struct future_queue::FutureQueueGrouped">FutureQueueGrouped</a>&lt;Self, K&gt;<div class="where">where
    I: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = (K, <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>)&gt;,
    K: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/cmp/trait.Eq.html" title="trait core::cmp::Eq">Eq</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/hash/trait.Hash.html" title="trait core::hash::Hash">Hash</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;Q&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a>,
    Q: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/cmp/trait.Eq.html" title="trait core::cmp::Eq">Eq</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/hash/trait.Hash.html" title="trait core::hash::Hash">Hash</a> + <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a>,
    Self: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a> + <a class="trait" href="../futures_core/stream/trait.Stream.html" title="trait futures_core::stream::Stream">Stream</a>&lt;Item = (<a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>, <a class="enum" href="https://doc.rust-lang.org/1.91.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;Q&gt;, F)&gt;,
    F: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="struct" href="struct.FutureQueueContext.html" title="struct future_queue::FutureQueueContext">FutureQueueContext</a>) -&gt; Fut,
    Fut: <a class="trait" href="https://doc.rust-lang.org/1.91.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>,</div></h4></section></summary><div class="docblock"><p>An adaptor for creating a queue of pending futures, where each future has a different weight
and optional group.</p>
<p>This method accepts a maximum global weight, as well as a set of <em>groups</em> of type <code>K</code>. Each
group has a defined maximum weight. This stream must return values of type <code>(usize, Option&lt;Q&gt;, F)</code>, where <code>K</code> is <code>Borrow&lt;Q&gt;</code>, and <code>F</code> is <code>FnOnce(FutureQueueContext) -&gt; impl Future)</code>.</p>
<p>This adapter will buffer futures up to weight <code>max_weight</code>. If the optional group is
specified for a future, it will also check that the weight of futures in that group does not
exceed the specified limit. Any futures that exceed the group’s weight limit will be queued
up, but not scheduled until the weight of futures in that group falls below the limit.</p>
<p>Like with <a href="trait.StreamExt.html#method.future_queue"><code>future_queue</code></a>:</p>
<ul>
<li>The maximum global and group weights is never exceeded while futures are being run.</li>
<li>While accounting against global weights, if the weight of an individual future is greater
than the maximum weight, its weight will be set to the maximum weight.</li>
<li><em>If a future belongs to a group:</em> While accounting against the group weight, if its weight
is greater than the maximum group weight, its weight will be set to the maximum group
weight.</li>
</ul>
<p>The adaptor is as fair as possible under the given constraints: it will schedule futures in
the order they’re returned by the stream, without doing any reordering based on weight. When
a future from a group completes, queued up futures in this group will be preferentially
scheduled before any other futures from the provided stream.</p>
<p>The weight of a future can be zero, in which case it will not count towards the total weight.</p>
<p>The returned stream will be a stream of each future’s output.</p>
<h5 id="panics"><a class="doc-anchor" href="#panics">§</a>Panics</h5>
<p>The stream panics if the optional group provided by a stream element isn’t in the set of
known groups.</p>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-StreamExt-for-T" class="impl"><a class="src rightside" href="../src/future_queue/lib.rs.html#182">Source</a><a href="#impl-StreamExt-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="trait.StreamExt.html" title="trait future_queue::StreamExt">StreamExt</a> for T<div class="where">where
    T: <a class="trait" href="../futures_core/stream/trait.Stream.html" title="trait futures_core::stream::Stream">Stream</a> + ?<a class="trait" href="https://doc.rust-lang.org/1.91.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></div><script src="../trait.impl/future_queue/trait.StreamExt.js" async></script></section></div></main></body></html>